### This is a work in progress and is still being updated with the full list of solutions. You're welcome to add your own!

These solutions are intended for use with WebGoat Version 8

***

## HTTP Basics, Lesson 2 Exercise
Enter any input and click Go. Observe the HTTP traffic using a web proxy (e.g. OWASP ZAP)

## HTTP Basics, Lesson 3 Exercise
The HTTP request observed in the previous exercise was a POST message. The magic number is hidden in the webpage's javascript. One of the methods to view this is to right click on the webpage and select "Inspect Element". In the section where the webpage's HTML appears, search for the phrase "magic" until you identify the value stored by the hidden "magic_num" field.

## HTTP Proxies, Lesson 6 Exercise
First follow the instructions on this page to start intercepting requests with OWASP ZAP. After clicking the Submit button:
1. Change the Method of the request to GET using the Method dropdown menu option. You should observe the "changeMe" variable that was previously in the HTTP request body is now appended to the URL with
`changeMe=doesn't+matter+really`
2. Copy the header `x-request-intercepted:true` and paste it into the request (I chose to paste it under the similarly named X-Requested-With header) 
3. Modify the value of `changeMe` in the URL to `Requests+are+tampered+easily`

Click the play button within ZAP to send the modified request. 

## SQL Injection (advanced), Lesson 3 Exercise
To dump the user_system_data table and view Dave's password, submit the following in the "Name" form: <br>
`name'; select * from user_system_data;--` <br>
Now that the table has been dumped, observe dave's password and enter it in the password text field

## SQL Injection (advanced), Lesson 5 Exercise
The Login form does not appear to provide any useful outputs from a variety of inputs, but the Register form allows us to check whether a username already exists. If we try to register with the following username:<br>
`tom' AND '1'='1`<br>
we find that the username is taken. We can use this as an oracle and check what tom's password is one at a time. Fortunately, the table we are seeking is named "password", so we can attempt to register with the following username:<br>
`tom' AND substring(password,1,1)='t`<br>
and because the response states the username already exists, we know that "t" is the first character of Tom's password. By fuzzing for the remaining characters, we can determine that tom's password is thisisasecretfortomonly

## SQL Injection, Lesson 7 Exercise
In "Account Name" form, enter:
`Smith' or '1'='1`

## SQL Injection, Lesson 8 Exercise
`123 or 1=1`

## SQL Injection (mitigation), Lesson 8 Exercise
Click on the name of one of the columns in the list of servers and observe the HTTP request that is sent using a web proxy (e.g. OWASP ZAP). We will modify the value of "column=" to execute this attack. As Lesson 7 of this section shows, we can ask the database a question using the when(...) portion of a case statement. We can use this to piece together the full IP address of the webgoat-prd server by inquiring about each individual digit of the IP address, one at a time. To ask the database whether the first digit of the IP of webgoat-prd is 1, we can resend the previous sort request but modify the URL to: <br>
`column=(case when (select ip from servers where hostname='webgoat-prd' and substr(ip,1,1) = '1') IS NOT NULL then hostname else id end)` <br>
If the server's response shows the servers sorted by id, we guessed the wrong value. Alternatively, if the server's response shows the servers sorted by hostname, we have identified the correct digit for that index. Using the Fuzzer feature built into ZAP, we can iterate through the entire IP address and determine which value is correct for each index. Keep in mind that if no digits 0-9 yield a server list sorted by hostname, the IP address may contain a period at that index (as is the case for indices 4, 8, and 12). After fuzzing each index of the IP address, we determine that webgoat-prd is located at 104.130.219.202.

## XXE, Lesson 3 Exercise
Enter and submit a comment. Using a web proxy (e.g. OWASP ZAP), observe the XML in the body of the request. Resend the request, but first edit the XML in the body to something like: <br>
`<?xml version="1.0"?> <!DOCTYPE comment [ <!ENTITY rootpath SYSTEM "file:///"> ]> <comment><text>&rootpath;</text></comment>`

## XXE, Lesson 4 Exercise
Enter and submit a comment. Using a web proxy (e.g. OWASP ZAP), note how the request body has changed from the previous exercise (Lesson 3), while the webpage looks very similar. We can attempt the same result as Lesson 3 with the identical request body: <br>
`<?xml version="1.0"?> <!DOCTYPE comment [ <!ENTITY rootpath SYSTEM "file:///"> ]> <comment><text>&rootpath;</text></comment>` <br>
But as the response suggests, we can't submit XML when the Content-Type is `application/json`. We can fix this problem by changing the Content-Type to `application/xml`, and sending the above XML as before.

## XXE, Lesson 7 Exercise
Awaiting solution...

## Authentication Bypass, Lesson 2 Exercise
Enter values into both security question forms and click the Submit button. Using a web proxy (e.g. OWASP ZAP), observe the HTTP request sent by the client. Edit the `secQuestion0` variable name to `secQuestion2` and change the `secQuestion1` variable to `secQuestion3` and resend the request

## JWT tokens, Lesson 4 Exercise
After selecting a user (Tom, Jerry, or Sylvester), attempt to reset votes and capture the access token JWT in the request using a web proxy (e.g. OWASP ZAP). Decode the token (e.g. using https://jwt.io/). Copy the token header, edit the "alg" field from "HS256" to "none". Copy the new header and use a Base64 converter to converter the ASCII to Base64 to serve as the new header. The resulting new header is `eyJhbGciOiJub25lIn0=`. Remove the signature portion of the JWT, but leave a trailing period. Use the same JWT payload as before, but with the "admin" field set to "true". The result should be a JWT similar to: `eyJhbGciOiJub25lIn0=.eyJpYXQiOjE1NDMzNzU1MjIsImFkbWluIjoidHJ1ZSIsInVzZXIiOiJUb20ifQ.`

**NOTE:** a bug may cause the "4" for Lesson 4 to remain red (indicating incompleteness) instead of green (indicating completeness)

## JWT tokens, Lesson 5 Exercise
Awaiting solution...

## JWT tokens, Lesson 7 Exercise
Awaiting solution...

## JWT tokens, Lesson 8 Exercise
See lesson 4. Change alg to "none" and username to "Tom". Encode it and remove the signature part.

## Password reset, Lesson 2 Exercise
Awaiting solution...

## Password reset, Lesson 4 Exercise
Awaiting solution...

## Password reset, Lesson 5 Exercise
Awaiting solution...

## Cross Site Scripting, Lesson 2 Exercise
Yes

## Cross Site Scripting, Lesson 7 Exercise
After using the default data entries, observe that the user-filled credit card number is reflected to the user in the webpage's thank you message. Replace the credit card number with the following javascript: <br>
`<script>alert('This is an example of reflected XSS')</script>`

## Cross Site Scripting, Lesson 10 Exercise
Clicking the Submit button without input (or with an incorrect solution) prompts the suggestion to look at the GoatRouter.js file. Within this file, we see a few uses of the word "test" and can discern that the test path is:
`start.mvc#test/`

## Cross Site Scripting, Lesson 11 Exercise
Using the start.mvc#test/ route we discovered in the previous exercise, we can append the suggested function directly into the URL, as follows:<br>
`http://localhost:8080/WebGoat/start.mvc#test/<script>webgoat.customjs.phoneHome()<%2Fscript>`<br>
Once the above URL is opened in a new tab, watch your proxy to see the phoneHome value

## Cross Site Scripting, Lesson 13 Exercise
This very similar to the previous exercise, but the input must be provided into the input form. We can enter an input such as:<br>
`Haha stored XSS <script>webgoat.customjs.phoneHome()</script>`<br>
And as before the phoneHome value will appear in your proxy

## Insecure Direct Object Reference, Lesson 2 Exercise
Use the provided credentials to login <br>
user: `tom` <br>
pass: `cat`

## Insecure Direct Object Reference, Lesson 3 Exercise
Click the "View Profile" button.
Using a web proxy (e.g. OWASP ZAP), observe the body of the server's response to the profile request.
Enter the two extra attributes seen in the web proxy (comma delimited): <br>
`userId, role`

**NOTE:** a bug may cause the "3" for Lesson 3 to remain red (indicating incompleteness) instead of green (indicating completeness)

## Insecure Direct Object Reference, Lesson 4 Exercise
We can observe that in Lesson 3, the profile request was directed at WebGoat/IDOR/profile
We can infer that in order to request a specific profile, a unique profile attribute may be appended to this URL, so using the userId from the previous answer, enter: <br>
`WebGoat/IDOR/profile/2342384`

## Insecure Direct Object Reference, Lesson 5 Exercise
Part 1: Click the first View Profile button on the page, capture the request using a web proxy (e.g. OWASP ZAP), and observe that the userId value is sent in the URL of the HTTP request. Since we do not know the userId of other users, we can either try incrementing the userId by hand, starting with our known userId (2342384), or we can use a fuzzing tool in our web proxy. Using either method, we can find that Buffalo Bill's userId is 2342388.<br>
Part 2: To edit Buffalo Bill's profile, we must use the prior HTTP request with some modifications. First, we confirm that Buffalo Bill's userId, 2342388, is in the request URL. We must know that a REST API can use the HTTP PUT method to provide updates, so we change the HTTP request to a PUT request. Next, we need to provide RESTful values in the request body, so we past the following into the body:<br>
`{"role":"1", "color":"red", "size":"small", "name":"Buffalo Bob", "userId":"2342388"}`<br>
Lastly, we must change the Content-Type from _application/x-www-form-urlencoded_ to _application/json_ for the server to correctly process the request.

## Missing Function Level Access Control, Lesson 2 Exercise
Right click on the webpage and select "Inspect Element". In the tab where the webpage's HTML is visible, use the search function to locate all instance of the word "hidden". We find menu headers with the "hidden-menu-item" class value. The hidden header is "Admin" while the two menu panels below it (and the solutions to this exercise) are "Users" and "Config".

## Missing Function Level Access Control, Lesson 3 Exercise
Awaiting solution...

## Insecure Login, Lesson 2 Exercise
Using a web proxy (e.g. OWASP ZAP), observe the request transmitted after the Log in button is clicked. The body of the captured request contains: <br>
`{"username":"CaptainJack","password":"BlackPearl"}`

**NOTE:** a bug may cause the "2" for Lesson 2 to remain red (indicating incompleteness) instead of green (indicating completeness)

## Insecure Deserialization, Lesson 5 Exercise
Awaiting solution...

## Cross-Site Request Forgeries, Lesson 3 Exercise
Click the "Submit Query" button. Observe the URL of the page that opens includes a field titled "csrf". Modify the URL to the following and view the message: <br>
`http://localhost:8080/WebGoat/csrf/basic-get-flag?csrf=true&submit=Submit+Query` <br>
The flag is on the webpage when the correct URL (the line above) is accessed in a separate window/tab

## Cross-Site Request Forgeries, Lesson 4 Exercise
Make a fake .html file locally to act as a webpage. The .html file will include hidden form fields, such as the following. Remember to replace the "validateReq" token value with your own value! <br>
`<html><body><form action="http://localhost:8080/WebGoat/csrf/review" method="POST"><input type="hidden" name="reviewText" value="Amazing Review"><input type="hidden" name="stars" value="5"><input type="hidden" name="validateReq" value="2aa14227b9a13d0bede0388a7fba9aa9"></form> <script>document.forms[0].submit();</script></body></html>` <br>
Now open this webpage in the same browser as while logged in to your webgoat account

## Cross-Site Request Forgeries, Lesson 7 Exercise
Awaiting solution...

## Cross-Site Request Forgeries, Lesson 8 Exercise
Awaiting solution...

## Vulnerable Components, Lesson 5 Exercise
Nothing to do here, just click the two "Go!" buttons

## Vulnerable Components, Lesson 12 Exercise
This exercise likely needs updated answer validation, since WebGoat doesn't appear to accept proof of concepts from the web. That being said, the WebGoat source code shows an answer such as the following will suffice:<br>
`<contact>`<br>
    `<java.lang.Integer>1</java.lang.Integer>`<br>
    `<firstName>Bruce</firstName>`<br>
    `<lastName>Mayhew</lastName>`<br>
    `<email>webgoat@owasp.org</email>`<br>
`</contact>`

## Bypass front-end restrictions, Lesson 2 Exercise
If you are using a recent version of Mozilla Firefox or Google Chrome, right click one of the input fields and select "Inspect Element" from the menu. In the HTML inspector, modify the four input fields to:
* Add a third option named "option3" to the selection menu and select it
* Add a third radio button with a value of "option3" and select it
* Change the checkbox input type field to "text" and enter some text
* Adjust the text input field maxlength variable to a value greater than the default value of 5 and add extra characters to the input value

## Bypass Front-End Restrictions, Lesson 3 Exercise
Submit the form using the default values. Then, using a web proxy (e.g. OWASP ZAP), edit the request with the web proxy and modify the values of the fields to values that do not fit the regular expressions. For example, the following request body will work: <br>
`field1=Zabc&field2=Z123&field3=*abc+123+ABC&field4=Zseven&field5=Z01101&field6=Z90210-1111&field7=Z301-604-4882&error=0`

## Client Side Filtering, Lesson 2 Exercise
Select any employee name from the menu. Using a web proxy (e.g. OWASP ZAP), observe that the response from the server includes the full details (salary, UserID, SSN) for all users, including the CEO, Neville Bartholomew. Enter Neville's salary into the submission box 

## Client Side Filtering, Lesson 3
Enter a random value for the "Checkout Code" and click the "Buy" button and observe the request using a web proxy (e.g. OWASP ZAP). Two requests are made - one to `clientSideFiltering/challenge-store/coupons/` and one to `clientSideFiltering/getItForFree/whatever-you-wrote-for-checkout-code`. By accessing the latter URL with an empty value for the checkout code, like so: <br>
`http://localhost:8080/WebGoat/clientSideFiltering/challenge-store/coupons/` <br>
We can see all the possible coupon codes, and determine that "get_it_for_free" provides a 100% discount

## HTML Tampering, Lesson 2
Right click the "Checkout" button and select "Inspect Element" from the right click menu. Observe that within the HTML source, below the button, is a hiden input field. Modify the value of this hidden input to a cost below 2999. Then click the green "Checkout" button.

## Admin lost password
Awaiting solution...

## Without password
Awaiting solution...

## Creating a new account
Awaiting solution...

## Admin password reset
Awaiting solution...

## Without account
Awaiting solution...